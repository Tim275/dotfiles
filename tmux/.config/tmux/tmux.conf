source-file ~/.config/tmux/tmux.reset.conf
set-option -g default-terminal 'screen-256color'
set-option -g terminal-overrides ',xterm-256color:RGB'

set -g prefix ^A
set -g base-index 1              # start indexing windows at 1 instead of 0
set -g detach-on-destroy off     # don't exit from tmux when closing a session
set -g escape-time 0             # zero-out escape time delay
set -g history-limit 1000000     # increase history size (from 2,000)
set -g renumber-windows on       # renumber all windows when any window is closed
set -g set-clipboard on          # use system clipboard
set -g status-position top       # macOS / darwin style
set -g default-terminal "${TERM}"
setw -g mode-keys vi
set -g mouse on                  # Mouse: resize panes, select, scroll
set -g focus-events on           # Focus events for vim autoread
set -g aggressive-resize on      # Resize based on smallest client viewing

# Quick Config Reload
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# Intuitive Splits (keep current path) - German keyboard friendly
bind h split-window -h -c "#{pane_current_path}"
bind v split-window -v -c "#{pane_current_path}"

# ══════════════════════════════════════════════════════════════════════════════
# PRIMEAGEN-STYLE KEYBINDINGS
# ══════════════════════════════════════════════════════════════════════════════

# Sessionizer - Prefix + f for fuzzy project switching
bind-key f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"

# Cheat sheet - Prefix + i for quick reference via cht.sh
bind-key i run-shell "tmux neww ~/.local/bin/tmux-cht"

# Kube context switcher - Prefix + Ctrl-k
bind-key C-k run-shell "tmux neww ~/.local/bin/kube-context"

# Quick window switching with Alt+number
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5

# ============================================================================
# TOKYO NIGHT THEME - Beautiful & Feature-Rich
# ============================================================================

# Theme variant: night (default), storm, day
set -g @tokyo-night-tmux_theme "night"

# Window number styles: digital, roman, fsquare, hsquare
set -g @tokyo-night-tmux_window_id_style "digital"
set -g @tokyo-night-tmux_pane_id_style "hsquare"
set -g @tokyo-night-tmux_zoom_id_style "dsquare"

# Widgets - RIGHT SIDE
set -g @tokyo-night-tmux_show_datetime 1
set -g @tokyo-night-tmux_date_format MYD
set -g @tokyo-night-tmux_time_format 24H

set -g @tokyo-night-tmux_show_path 1
set -g @tokyo-night-tmux_path_format relative

set -g @tokyo-night-tmux_show_battery_widget 1
set -g @tokyo-night-tmux_battery_name "InternalBattery-0"
set -g @tokyo-night-tmux_battery_low_threshold 20

set -g @tokyo-night-tmux_show_netspeed 0
set -g @tokyo-night-tmux_show_hostname 0

# Git - Shows branch and status
set -g @tokyo-night-tmux_show_git 1
set -g @tokyo-night-tmux_show_wbranch 1

# Pane borders
set -g pane-border-lines single

set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'
set -g @fzf-url-history-limit '2000'

# Vim-Tmux Navigator (seamless Ctrl+hjkl between nvim and tmux)
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'fcsonline/tmux-thumbs'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'wfxr/tmux-fzf-url'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'omerxx/tmux-floax'
set -g @plugin 'jaclu/tmux-menus'
set -g @plugin 'laktak/extrakto'
set -g @plugin 'jabirali/tmux-tilish'
set -g @plugin 'janoamaral/tokyo-night-tmux'

# Floax Settings
set -g @floax-width '80%'
set -g @floax-height '80%'
set -g @floax-border-color 'cyan'
set -g @floax-text-color 'white'
set -g @floax-bind 'p'
set -g @floax-change-path 'true'

# SessionX Settings
set -g @sessionx-bind-zo-new-window 'ctrl-y'
set -g @sessionx-auto-accept 'off'
set -g @sessionx-custom-paths '/Users/timour/dotfiles,/Users/timour/Desktop/kubecraft'
set -g @sessionx-bind 'o'
set -g @sessionx-x-path '~/dotfiles'
set -g @sessionx-window-height '85%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-custom-paths-subdirectories 'false'
set -g @sessionx-filter-current 'false'

# Continuum & Resurrect
set -g @continuum-restore 'off'
set -g @resurrect-strategy-nvim 'session'

# Tmux Menus - Prefix + \ for visual menu
set -g @menus_trigger '\'

# Extrakto - Prefix + Tab to fuzzy-copy from terminal output
set -g @extrakto_key 'tab'
set -g @extrakto_split_size '15'
set -g @extrakto_clip_tool 'pbcopy'

# Tilish - Tiling window manager keybindings
set -g @tilish-default 'main-vertical'

run '~/.tmux/plugins/tpm/tpm'

# ──────────────────────────────────────────────────────────────────────────────
# CUSTOM K8S WIDGET (nach TPM damit Tokyo Night nicht überschreibt)
# ──────────────────────────────────────────────────────────────────────────────
set -ga status-left " #[fg=#bb9af7]#(~/.config/tmux/scripts/kube.sh)"
